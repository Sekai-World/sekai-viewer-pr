(this["webpackJsonpsekai-viewer"]=this["webpackJsonpsekai-viewer"]||[]).push([[78],{1097:function(e,t,n){"use strict";n.r(t);var c=n(24),r=n(9),a=n.n(r),i=n(25),s=n(8),o=n(296),u=n(519),d=n(135),l=n(89),j=n(1061),b=n(256),v=n(316),O=n(498),p=n(1110),f=n(0),x=n(213),h=n(37),m=n(48),k=n(309),w=n(49),_=n(1);t.default=function(e){var t=Object(x.a)().t,n=Object(f.useContext)(h.c),r=n.jwtToken,g=n.sekaiProfile,I=n.updateSekaiProfile,S=Object(k.f)(r),C=S.getSekaiProfileEventRecordMe,G=S.postSekaiProfileEventRecord,L=Object(w.b)().getTranslated,E=Object(f.useContext)(h.a).contentTransMode,P=Object(k.b)(),U=P.currEvent,z=P.isLoading,M=Object(m.g)("events"),y=Object(s.a)(M,1)[0],J=Object(f.useState)(null),R=Object(s.a)(J,2),T=R[0],A=R[1],F=Object(f.useState)([]),D=Object(s.a)(F,2),N=D[0],V=D[1],W=Object(f.useState)(!1),q=Object(s.a)(W,2),B=q[0],H=q[1];return Object(f.useEffect)((function(){Object(i.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!U||!y){e.next=14;break}return(t=y.find((function(e){return e.id===Number(U.eventId)})))&&A({name:L("event_name:".concat(U.eventId),t.name),id:t.id}),e.prev=3,e.t0=V,e.next=7,C(U.eventId);case 7:e.t1=e.sent,(0,e.t0)(e.t1),e.next=14;break;case 11:e.prev=11,e.t2=e.catch(3),V([]);case 14:case"end":return e.stop()}}),e,null,[[3,11]])})))()}),[E,U,y,C,L]),Object(_.jsxs)(o.a,{container:!0,direction:"column",spacing:1,children:[Object(_.jsxs)(o.a,{item:!0,container:!0,spacing:1,alignItems:"center",children:[Object(_.jsx)(o.a,{item:!0,children:Object(_.jsx)(p.a,{options:(y||[]).slice().reverse().map((function(e){return{name:L("event_name:".concat(e.id),e.name),id:e.id}})),getOptionLabel:function(e){return e.name},getOptionSelected:function(e,t){return e.id===t.id},renderInput:function(e){return Object(_.jsx)(u.a,Object(c.a)(Object(c.a)({},e),{},{label:t("event:tracker.select.event_name")}))},value:T,autoComplete:!0,onChange:function(){var e=Object(i.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(A(n),V([]),!n){e.next=8;break}return e.t0=V,e.next=6,C(n.id);case 6:e.t1=e.sent,(0,e.t0)(e.t1);case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),disabled:z||B,style:{minWidth:"250px"}})}),Object(_.jsx)(o.a,{item:!0,children:Object(_.jsx)(d.a,{variant:"contained",onClick:Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return A({name:L("event_name:".concat(U.eventId),U.eventJson.name),id:U.eventId}),V([]),e.t0=V,e.next=5,C(U.eventId);case 5:e.t1=e.sent,(0,e.t0)(e.t1);case 7:case"end":return e.stop()}}),e)}))),disabled:z||B,children:t("event:tracker.button.curr_event")})})]}),Object(_.jsxs)(o.a,{item:!0,container:!0,spacing:1,alignItems:"center",children:[Object(_.jsx)(o.a,{item:!0,children:Object(_.jsx)(l.a,{children:t("user:profile.event.current_record_info")})}),!!T&&T.id===U.eventId&&!!g&&Object(_.jsx)(o.a,{item:!0,children:Object(_.jsx)(j.a,{title:t("user:profile.label.update_left",{allowed:g.eventGetAvailable,used:g.eventGetUsed}),disableFocusListener:!0,arrow:!0,interactive:!0,children:Object(_.jsx)("span",{children:Object(_.jsx)(b.a,{size:"small",onClick:function(){H(!0),G(U.eventId).then(function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=V,e.next=3,C();case 3:e.t1=e.sent,(0,e.t0)(e.t1),I({eventGetUsed:g.eventGetUsed+1}),H(!1);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},disabled:z||B||g.eventGetAvailable<=g.eventGetUsed,children:B?Object(_.jsx)(v.a,{size:24}):Object(_.jsx)(O.a,{})})})})}),N[0]&&Object(_.jsxs)(f.Fragment,{children:[Object(_.jsx)(o.a,{item:!0,children:Object(_.jsxs)(l.a,{children:[t("user:profile.event.current_record_point")," ",N[0].eventPoint]})}),Object(_.jsx)(o.a,{item:!0,children:Object(_.jsxs)(l.a,{children:[t("user:profile.event.current_record_rank")," ",N[0].eventRank]})}),Object(_.jsx)(o.a,{item:!0,children:Object(_.jsxs)(l.a,{children:[t("user:profile.event.current_record_time")," ",new Date(N[0].created_at).toLocaleString()]})})]})]})]})}},498:function(e,t,n){"use strict";var c=n(0),r=n(14);t.a=Object(r.a)(c.createElement("path",{d:"M21 10.12h-6.78l2.74-2.82c-2.73-2.7-7.15-2.8-9.88-.1-2.73 2.71-2.73 7.08 0 9.79s7.15 2.71 9.88 0C18.32 15.65 19 14.08 19 12.1h2c0 1.98-.88 4.55-2.64 6.29-3.51 3.48-9.21 3.48-12.72 0-3.5-3.47-3.53-9.11-.02-12.58s9.14-3.47 12.65 0L21 3v7.12zM12.5 8v4.25l3.5 2.08-.72 1.21L11 13V8h1.5z"}),"Update")}}]);